<!DOCTYPE html><html><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0">
<!-- 
 **
 *  This file is part of Wigii.
 *  Wigii is developed to inspire humanity. To Humankind we offer Gracefulness, Righteousness and Goodness.
 *  
 *  Wigii is free software: you can redistribute it and/or modify it 
 *  under the terms of the GNU General Public License as published by
 *  the Free Software Foundation, either version 3 of the License, 
 *  or (at your option) any later version.
 *  
 *  Wigii is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; 
 *  without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  
 *  See the GNU General Public License for more details.
 *
 *  A copy of the GNU General Public License is available in the Readme folder of the source code.  
 *  If not, see <http://www.gnu.org/licenses/>.
 *
 *  @copyright  Copyright (c) 2016-2017  Wigii.org
 *  @author     <http://www.wigii.org/system/libs>      Wigii.org 
 *  @link       <http://www.wigii-system.net>           <https://github.com/wigii/wigii>   Source Code
 *  @license    <http://www.gnu.org/licenses/>          GNU General Public License
 *
-->
<!-- <LIBRAIRIES WIGII.ORG NCD LIBRARIES> -->
<script src="https://resource.wigii.org/assets/js/wigii-core.js" type="text/javascript"></script>
<link media="all" type="text/css" href="https://resource.wigii.org/assets/css/wigii-core.css" rel="stylesheet">
<link media="all" type="text/css" href="https://resource.wigii.org/assets/css/theme.css.php" rel="stylesheet">
<link media="all" type="text/css" href="https://www.wigii.org/system/libs/wigii-ncd-core.min.css" rel="stylesheet"/>
<!-- </LIBRAIRIES WIGII.ORG NCD LIBRARIES> -->
<title>NCD doc Reference</title>
<style>
html,body, div#mainDiv {		
	font-family:Sans-serif;
	box-sizing:border-box;
	height:100%;
	width:100%;
	margin: 0;
	padding: 0;	
}
div#mainDiv * {
	box-sizing:border-box;
}
p.title {
	font-size:32px;
	padding-top:10px;
}
img.logo {
	margin:15px;
}
div.userMenuContainer {
	padding:8px;	
}
div.userMenuContainer > span.userMenuButton {
	cursor:pointer;
	font-size:30px;
	display:none;
}
div.headerBar {
	padding-top: 25px;
}
div.footerBar {
	padding-top:12px;
	padding-left:5px;
	border-top: solid black 1px;
	color:#3333ff;
}
div.footerBar span.ncd {
	font-size:15px;
}
div.headerBar > input.searchBar {
	width:80%;	
}
div.headerBar > button.searchBarButton {
	margin-left:10px;
}
div.headerBar > div.autocompletionsense {
	width:80%;
	max-height:80vh;
}
div.docBrowser {
	overflow-y:auto;
}

div#nullEmitter {
	display:none;
}
div.method {
	margin:10px 30px;
}
span.methodName {	
}
span.classKeyword {
	padding-right: 8px;
}
span.functionKeyword {
	padding-right: 8px;
}
span.keyword {
	color:blue;
}
span.methodExpand {
	cursor:pointer;
	padding-right:8px;	
}
div.methodSrc, div.classSrc {
	display:none;
}
div.methodSrc textarea, div.classSrc textarea {
	white-space:pre;
}
span.methodSrcExpand, span.classSrcExpand {
	cursor:pointer;
	padding-left:8px;	
}
span.typeAssignement {
	padding-left: 8px;
	padding-right: 8px;
}
span.scalarValue {
}
</style>
</head><body>
<div id="mainDiv"></div>
<!-- NCD initialization -->
<script type="text/javascript">
window.wigiiNcdEtp = {options:{
	/**
	 * Defines program output location
	 */
	programOutput: "#mainDiv",
	/**
	 * Callback when Wigii NCD ETP layer is ready
	 */
	ncdEtpReady: function(wigiiNcdEtp) {
		if(!wigiiNcdEtp.startupLog) wigiiNcdEtp.startupLog = {};
		wigiiNcdEtp.startupLog.ncdEtpReady=true;
		wigiiNcdEtp.startupLog.version = wigiiNcdEtp.version();
	},
	/**
	 * Callback when Wigii NCD ETP Fx layer is ready
	 */
	ncdEtpFxReady: function(wigiiNcdEtp) {
		if(!wigiiNcdEtp.startupLog) wigiiNcdEtp.startupLog = {};
		wigiiNcdEtp.startupLog.ncdEtpFxReady=true;
		wigiiNcdEtp.program.context.startupLog = wigiiNcdEtp.startupLog;
	}
}};
</script>
<!-- <LIBRAIRIES WIGII.ORG NCD ETP LIBRARIES> -->
<script src="https://www.wigii.org/system/libs/wigii-ncd-core.js"></script>
<!-- </LIBRAIRIES WIGII.ORG NCD ETP LIBRARIES> -->
<!-- NCD program -->
<script type="text/javascript">program(
/**
 * Wigii NCD Custom libraries
 */
script(function(){
	/**
	 * A desktop user interface which displays a user menu, a header bar, a workzone and a footer bar.
	 * It accepts  to display desktop components which should display a header bar, a workzone and a footer bar.
	 * It supports an activate component event and a close event. The activate event is fired when a component is brought to the screen,
	 * the close event is fired when a component is brought off the screen.
	 *@param Object options a set of options to configure the desktop component. It supports the following attributes :
	 * - htmlEmitter: HtmlEmitter|JQuery. A reference of where to render the desktop user interface. Can be an open HtmlEmitter or a JQuery selector.
	 * - label: Label used to display the desktop
	 * - height: height of the desktop in his container. Defaults to 100%
	 * - width: width of the desktop in his container. Defaults to 100%
	 */
	wncd.Desktop = function(options) {
		var self = this;
		self.className = 'Desktop';
		self.instantiationTime = Date.now();
		self.ctxKey = wncd.ctxKey+'_'+self.className;
		self.options = options || {};
		self.context = {
			components: {},
			currentComponent: undefined
		};
		self.impl = {
			onCloseSubscribers:[],
			onActivateSubscribers:[]
		};
		
		// Define default options
		if(!self.options.userMenuLabel) self.options.userMenuLabel = "&#9776;"; //trigram of heaven
		if(!self.options.label) self.options.label = "&#127968;"; //house building
		self.options.obj = self;
		if(!self.options.height) self.options.height = "100%";
		if(!self.options.width) self.options.width = "100%";
		
		/**
		 *Defines default HtmlEmitter
		 */
		if(!self.options.htmlEmitter) self.options.htmlEmitter = wncd.currentDiv();
		else if($.type(self.options.htmlEmitter)==='string' || self.options.htmlEmitter.className != 'HtmlEmitter') {
			self.options.htmlEmitter = wncd.html(self.options.htmlEmitter);
		}
		
		/**
		 * Defines desktop displayHeaderBar function
		 */
		if(!self.options.displayHeaderBar) self.options.displayHeaderBar = function(desktop) {
			wncd.currentDiv().reset();
		};
		/**
		 * Defines desktop displayWorkzone function
		 */
		if(!self.options.displayWorkzone) self.options.displayWorkzone = function(desktop) {
			wncd.currentDiv().reset();
		};
		/**
		 * Defines desktop displayFooterBar function
		 */
		if(!self.options.displayFooterBar) self.options.displayFooterBar = function(desktop) {
			wncd.currentDiv().reset().out("Natural Code Development, Wigii.org (CWE), 27.11.2017");
			if(program.context.startupLog) {
				if(program.context.startupLog.ncdEtpReady) wncd.currentDiv().out(", Wigii NCD core v.").out(program.context.startupLog.version);
				if(program.context.startupLog.ncdEtpFxReady) wncd.currentDiv().out(", Fx layer ready").out("&nbsp").out(wncd.txtDate(new Date()));
			}
		};
		/**
		 * Defines desktop displayUserMenu function
		 */
		if(!self.options.displayUserMenu) self.options.displayUserMenu = function(desktop) {
			// creates the list of available components in a displayable order
			self.context.userMenu = [];
			for(var key in self.context.components) {
				self.context.userMenu.push(key);
			}
			wncd.currentDiv().reset().out(self.options.userMenuLabel,'userMenuButton')
			.$().find('span.userMenuButton').wncd('menu',{
				compose:function(n,subMenu,list) {
					// returns each component in the user menu
					if(n<self.context.userMenu.length) {
						var component = self.context.components[self.context.userMenu[n]];
						// sets the label
						if(component.options && component.options.label) component.label = component.options.label;
						else component.label = component.key;
						return component;
					}
				},
				onItemClick: function(i,component) {self.activate(component.key);},
				top:5,left:20,
				cssClass:'userMenu'
			});			
		};
		/**
		 * Defines desktop layout function
		 */
		if(!self.options.layoutDesktop) self.options.layoutDesktop = function(h,v,x1,x2,x3,x4,x5,x6,x7,x8,x9,x10,desktop) {
			return v(
				x3.h(
					/* user menu */
					x1.h(
						x1(function(){
							return wncd.getHtmlBuilder()
							.tag('img','class','logo','src','https://rise.wigii.org/NCD/CMS/www/etp/logo_wigii_48.gif').$tag('img')
							.html();
						}),
						x1().id(desktop.ctxKey+"_userMenu").cssClass("userMenuContainer")
					),
					/* header bar */
					x10.v(
						x1(function(){
							return wncd.getHtmlBuilder()
							.tag('p','class','title').out("Wigii ").tag('span','style','color:#3333ff').out("NCD").$tag('span').out(" Documentation reference").$tag('p')
							.html();
						}),
						x3().id(desktop.ctxKey+"_headerBar").cssClass("headerBar")
					)
				),
				/* workzone */
				x10().id(desktop.ctxKey+"_workzone").cssClass("workzone"),
				/* footer bar */
				x1().id(desktop.ctxKey+"_footerBar").cssClass("footerBar")
			).cssClass("desktop").width(desktop.options.width).height(desktop.options.height);
		};
		
		/**
		 * Registers a new component that can be displayed on the desktop
		 *@param String key the key under which the component is registered
		 *@param Function displayHeaderBar a function which display the component header bar using wncd.currentDiv() context. It receives the desktop as parameter.
		 *@param Function displayWorkzone a function which display the component workzone using wncd.currentDiv() context. It receives the desktop as parameter.
		 *@param Function displayFooterBar a function which display the component footer bar using wncd.currentDiv() context. It receives the desktop as parameter.
		 *@param Object options some options to configure the component registration. It supports the following attributes :
		 * - label: A label to put into a menu or button to activate the component
		 * - obj: An underlying object instance representing the component itself.
		 * - subMenu: A configured sub-menu for this component.
		 *@return wncd.Desktop for chaining
		 */
		self.registerComponent = function(key,
			displayHeaderBar,
			displayWorkzone,
			displayFooterBar, 
			options) {
			
			self.context.components[key] = {
				key: key,
				displayHeaderBar: displayHeaderBar,
				displayWorkzone: displayWorkzone,
				displayFooterBar: displayFooterBar,
				options: options
			};
			
			// displays user menu
			wncd.program.context.html(self.options.userMenuEmitter);
			self.options.displayUserMenu(self);
			
			return self;
		};
		/**
		 * Creates an instance of a desktop component given its class name and registers it into the desktop
		 *@param String className a wncd class which can be registred as a desktop component
		 *@param Objects options an optional map of options to be passed to the component constructor
		 *@return wncd.Desktop for chaining
		 */
		self.add = function(className,options) {
			var componentConstructor = wncd[className];
			if(!$.isFunction(componentConstructor)) throw wncd.createServiceException("Unsupported class "+className,wncd.errorCodes.UNSUPPORTED_OPERATION);
			new componentConstructor(self,options);
			return self;
		};
		
		/**
		 * Activates and brings to the screen a registered component given its key
		 *@return Object returns underlying component object if defined
		 */ 
		self.activate = function(key) {
			if(!key) throw wncd.createServiceException("key cannot be null",wncd.errorCodes.INVALID_ARGUMENT);
			var component = self.context.components[key];
			if(!component) throw wncd.createServiceException("no component registered under key "+key,wncd.errorCodes.INVALID_ARGUMENT);
			// closes previous component
			if(self.context.currentComponent) self.onClose();
			// changes current component key
			self.context.currentComponent = key;
			// activates the component
			self.onActivate();			
			// Renders component header bar
			if($.isFunction(component.displayHeaderBar)) {
				wncd.program.context.html(self.options.headerBarEmitter);
				component.displayHeaderBar(self);
			}
			// Renders component workzone			
			if($.isFunction(component.displayWorkzone)) {
				wncd.program.context.html(self.options.workzoneEmitter);
				component.displayWorkzone(self);
			}
			// Renders component footer bar			
			if($.isFunction(component.displayFooterBar)) {
				wncd.program.context.html(self.options.footerBarEmitter);
				component.displayFooterBar(self);			
			}
			// keeps current div on workzone.
			wncd.program.context.html(self.options.workzoneEmitter);
			
			return self.getComponentObject(key);
		};
		/**
		 * If the component has an underlying object, then returns it
		 */
		self.getComponentObject = function(key) {
			if(!key) throw wncd.createServiceException("key cannot be null",wncd.errorCodes.INVALID_ARGUMENT);
			var component = self.context.components[key];
			if(!component) throw wncd.createServiceException("no component registered under key "+key,wncd.errorCodes.INVALID_ARGUMENT);
			if(component.options) return component.options.obj;
		};
		/**
		 * Removes the current component off the screen and displays again the desktop
		 */
		self.closeCurrentComponent = function() {
			self.activate(self.ctxKey);
		};
		/**
		 * Registers an eventHandler which is called when a component is closed and took off the screen.
		 *@param Function closeEventHandler a function which receives the component key which is closed and the desktop
		 */
		self.onClose = function(closeEventHandler) {
			if($.isFunction(closeEventHandler)) {
				self.impl.onCloseSubscribers.push(closeEventHandler);
			}
			else if(closeEventHandler===undefined) {
				for(var i=0;i<self.impl.onCloseSubscribers.length;i++) {
					var eh = self.impl.onCloseSubscribers[i];
					if($.isFunction(eh)) eh(self.context.currentComponent, self);
				}
			}
			return self;
		};
		/**
		 * Registers an eventHandler which is called when a component is activated and took on the screen.
		 * This event is called before the component is asked to be rendered so that it can optionally prepare itself.
		 *@param Function activateEventHandler a function which receives the component key which is activated and the desktop
		 */
		self.onActivate = function(activateEventHandler) {
			if($.isFunction(activateEventHandler)) {
				self.impl.onActivateSubscribers.push(activateEventHandler);
			}
			else if(activateEventHandler===undefined) {
				for(var i=0;i<self.impl.onActivateSubscribers.length;i++) {
					var eh = self.impl.onActivateSubscribers[i];
					if($.isFunction(eh)) eh(self.context.currentComponent, self);
				}
			}
			return self;
		};
		
		// Lays out the desktop		
		self.options.htmlEmitter.layout(self.options.layoutDesktop,self);
		// Keeps the open emitters into memory
		self.options.userMenuEmitter = self.options.htmlEmitter.clone(self.options.htmlEmitter.$().find("div.desktop div#"+self.ctxKey+"_userMenu"));
		self.options.headerBarEmitter = self.options.htmlEmitter.clone(self.options.htmlEmitter.$().find("div.desktop div#"+self.ctxKey+"_headerBar"));
		self.options.workzoneEmitter = self.options.htmlEmitter.clone(self.options.htmlEmitter.$().find("div.desktop div#"+self.ctxKey+"_workzone"));
		self.options.footerBarEmitter = self.options.htmlEmitter.clone(self.options.htmlEmitter.$().find("div.desktop div#"+self.ctxKey+"_footerBar"));
		
		// Registers the default desktop component 
		self.registerComponent(self.ctxKey,
			self.options.displayHeaderBar,
			self.options.displayWorkzone,
			self.options.displayFooterBar,
			self.options);			
		// Activates the desktop
		self.activate(self.ctxKey);
	};
	wncd.createDesktop = function(options) {return new wncd.Desktop(options);}
	
	/**
	 * Documentation browser which displays a tree view of the documentation, 
	 * a search bar and a view with the detailed documentation and interactive examples
	 * @param wncd.Desktop container the container in which to deploy the ObjectDocBrowser. Today supports only wncd.Desktop.
	 * @param Object options a set of options to configure the desktop component. It supports the following attributes :
	 */
	wncd.ObjectDocBrowser = function(container, options) {
		var self = this;
		self.className = 'ObjectDocBrowser';
		self.instantiationTime = Date.now();
		self.ctxKey = wncd.ctxKey+'_'+self.className+self.instantiationTime;
		self.options = options || {};
		self.context = {};
		self.impl = {};
		
		// Define default options
		if(!self.options.label) self.options.label = "&#128214;"; // open book
		if(!self.options.searchButtonLabel) self.options.searchButtonLabel = "&#128270;"; // lense
		
		/**
		 * Renders search bar
		 */
		if(!self.options.renderSearchBar) self.options.renderSearchBar = function(container) {
			self.context.searchBar = wncd.currentDiv().reset().display(undefined,undefined,"searchBar");
			self.context.searchBar.$().on('change',function(){self.expandToMember($(this).val());});
			//wncd.currentDiv().button(self.options.searchButtonLabel,undefined,"searchBarButton");
		};
		/**
		 * Renders browser panel
		 */
		if(!self.options.renderBrowserPanel) self.options.renderBrowserPanel = function(container) {
			wncd.currentDiv().reset().layout(function(h,v,x1,x2,x3,x4,x5,x6,x7,x8,x9,x10){
				return h(
					x1(function(){
						//wncd.currentDiv().list(["&#9776;"]);
					}).cssClass("docBrowserToolbar"),
					x10(function(){
						wncd.currentDiv().div("wncd", "method").color("#3333FF").out("wncd").$color();
						self.context.wncdDoc = wncd.createObjectDoc(wncd,
							{docOutput:wncd.currentDiv().div("wncd"),
								expandLevel:5,
								noSorting:true,
								namespace:'wncd',
								privateValues:{}
							});
						// collapse all
						self.collapseAll();
						// initializes search bar
						self.context.searchBar.autocomplete(Object.keys(self.context.wncdDoc.context.docModel.members)).$().focus();
					}).cssClass("docBrowser").id(self.ctxKey)					
				).width("100%").height("100%");
			});
		};
		
		// Implementation
		
		/**
		 * Collapse all doc browser nodes, except first level
		 */
		self.collapseAll = function() {
			if(self.context.wncdDoc) {
				var wncdMembers = self.context.wncdDoc.context.docModel.libs['wncd'].members;
				for(var memberName in wncdMembers) {
					var ss = wncdMembers[memberName].context.selectionSense;
					if(ss && ss.selected()) ss.onClick();
				}
				$("#"+self.ctxKey).scrollTop(0);
			}
		};

		/**
		 * Expands tree to display given member and scrolls down to it.
		 *@param String qualifiedName the qualified name of the member to display
		 */
		self.expandToMember = function(qualifiedName) {
			if(!self.context.wncdDoc) return;
			// searches for member
			var member = self.context.wncdDoc.context.docModel.members[qualifiedName];
			if(!member) return;
			// expands member and goes up the tree
			var m = member;
			while(m) {
				if(m.context.selectionSense && !m.context.selectionSense.selected()) m.context.selectionSense.onClick();
				m = m.parent;
			}
			// scrolls to member
			$("#"+self.ctxKey).scrollTop(0).scrollTop($("#"+member.uri).offset().top-$("#"+self.ctxKey).offset().top);
		};
		
		// Deploys into container		
		// Only supports wncd.Desktop container
		if($.type(container)!=='object' || container.className != 'Desktop') throw wncd.createServiceException("container should be a non null instance of wncd.Desktop",wncd.errorCodes.INVALID_ARGUMENT);
		self.options.obj = self; // passes the ObjectDocBrowser to the Desktop through the component object
		container.registerComponent(self.ctxKey,self.options.renderSearchBar,self.options.renderBrowserPanel,undefined,self.options);
	};
}),
/**
 * Main script
 */
script(function(){	
	wncd.program.context.desktop = wncd.createDesktop().add("ObjectDocBrowser");
	wncd.program.context.desktop.activate(wncd.program.context.desktop.context.userMenu[1]);
}));</script></body></html>